# 1 Описание wf/definition

| Параметр       | Тип          | Описание                                                                                                                                                                                                 | Обязательность                             |
|----------------|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
| type           | String255    | Тип WF. Чаще всего complex. Составной тип примитива, используется для создания БП из нескольких действий. Выполняется и обрабатывается последовательность действий (activity).                          | обязательное                               |
|                |              | так же может быть:<br>• await_for_message. Ожидание вызова от внешней системы/внешнего БП с заранее заданным текстом.<br>• rest_call. Вызов MC (REST API).<br>• db_call. Вызов функции или выборки из БД.<br>• send_to_rabbitmq. Отправка сообщения в очередь rabbitmq<br>• send_to_sap. Отправка idoc в sap<br>• transform. трансформация. |                                            |
| name           | String255    | Имя WF                                                                                                                                                                                                  | обязательное                               |
| tenantId       | String255    | id системы которая использует WF                                                                                                                                                                        | необязательное, значение по умолчанию "default" |
| version        | Int          | Версия WF                                                                                                                                                                                               | необязательное, значение по умолчанию 1, при каждом редактировании WF увеличивается на 1 |
| description    | String4000   | Описание WF                                                                                                                                                                                             | необязательное                             |
| compiled       | Составной Compiled | Описание составного типа WF                                                                                                                                                                             | обязательное, если примитив составной (type = "complex") |
| details        | Составной DefinitionDetails | Для типа БП complex - описание ожидаемых параметров на вход БП для других типов БП - описание деталей БП                                                                                                | обязательное, если примитив простой (type != "complex") |
| flowEditorConfig | Составной    | Данные для UI, на исполнение схемы они не влияют                                                                                                                                                        | необязательное                             |

---

### Составной DefinitionDetails

| Параметр               | Тип                     | Описание                                                                                                                                                                                                 | Обязательность                                                                 |
|------------------------|-------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
| inputValidateSchema    | JsonObject              | Стандартная json schema https://www.jsonschemavalidator.net/ с описанием механизма проверки входящих переменных.                                                                                         | необязательное                                                                |
| outputValidateSchema   | JsonObject              | С помощью этого параметра можно задать параметры, ожидаемые на старт БП. Если старт БП не будет соответствовать параметрам, то экземпляр БП упадет с ошибкой 400.                                        | необязательное                                                                |
| starters               | Массив из составных starters | Стандартная json schema https://www.jsonschemavalidator.net/ с описанием механизма проверки исходящих переменных                                                                                         | необязательное                                                                |
| sendToKafkaConfig      | Составной sendToKafkaConfig | Описание параметров старта                                                                                                                                                                               | обязательный                                                                  |
| sendToS3Config         | Составной sendToS3Config   | Описание деталей вызова                                                                                                                                                                                  | обязательное, если FlowDefinition.type = 'send_to_kafka'                      |
| restCallConfig         | Составной restCallConfig   | Описание деталей вызова                                                                                                                                                                                  | обязательное, если FlowDefinition.type = 'send_to_s3'                         |
|                        |                         | Описание вызова REST                                                                                                                                                                                     | обязательное, если FlowDefinition.type = 'rest_call'                          |
| xslITransformConfig    | Составной xslITransformConfig | Описание xslit-трансформации                                                                                                                                                                             | обязательное, если FlowDefinition.type = 'xslit_transform'                   |
| databaseCallConfig     | Составной databaseCallConfig  | Описание вызова БД (select или function)                                                                                                                                                                  | обязательное, если FlowDefinition.type = 'db_call'                            |
| sendToRabbitingConfig  | Составной sendToRabbitingConfig | Описание отправки сообщения в Rabbiting                                                                                                                                                                   | обязательное, если FlowDefinition.type = 'send_to_rabbiting'                  |
| awaitForMessageConfig  | Составной awaitForMessageConfig | Описание ожидаемого сообщения от внешней системы                                                                                                                                                         | обязательное, если FlowDefinition.type = 'await_for_message'                  |
| sendToSapConfig        | Составной sendToSapConfig    | Описание параметров отправки idoc в sap                                                                                                                                                                   | обязательное, если FlowDefinition.type = 'send_to_sap'                        |

---

### Составной starters

| Параметр            | Тип          | Описание                                                                                                                                                                                                 | Обязательность                             |
|---------------------|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
| type                | String255    | Тип старта:<br>• kafka_consumer - старт схемы производится при вычитывании сообщения из очереди кафка<br>• sap_inbound - старт схемы производится при получении idoc в указанный канал SAP<br>• rest_call - старт схемы производится при вызове low-code с id схемы. Если не указан стартер, то по умолчанию присваивается rest_call<br>• scheduler - старт схемы по расписанию | обязательное                               |
| name                | String255    | Имя стартера                                                                                                                                                                                             | обязательное для всех типов старта кроме rest_call |
| description         | String255    | Описание стартера                                                                                                                                                                                        | необязательное                             |
| rabbitmqConsumer    | Составной rabbitmqConsumer | Описание деталей стартера подключения rabbitmq                                                                                                                                                           | обязательное, если стартер rabbitmq        |
| kafkaConsumer       | Составной kafkaConsumer   | Описание деталей подключения стартера kafka                                                                                                                                                              | обязательное, если стартер kafka          |
| saplnbound          | Составной saplnbound      | Описание деталей подключения стартера SAP                                                                                                                                                                | обязательное, если стартер SAP            |
| shedulerStarter     | Составной shedulerStarter | Описание деталей работы стартера по расписанию                                                                                                                                                           | обязательное, если стартер по расписанию  |

---

### Составной Compiled

| Параметр         | Тип          | Описание                                                                                                                                                                                                 | Обязательность                             |
|------------------|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
| start            | String255    | Указывается activity id, с которого начинается WF (точка входа start)                                                                                                                                   | обязательное, если примитив составной (type = "complex") |
| activities       | Составной Activity | Массив с описанием всех Activity данного WF                                                                                                                                                              | обязательное, если примитив составной (type = "complex") |
| outputTemplate   | JsonObject   | Фильтр всех данных запуска по завершению процесса. Если старт схемы будет производится с помощью синхронного REST-запроса и в ответ необходимо получить только определенные параметры, для более удобной их обработки, то необходимо указать необходимые для фильтрации параметры. | необязательный                             |